<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>run report</title>
    <style>
     html {
    font-family: sans-serif;
    --current-node-color: #15ed8f;
}

* *::before, *::after {
    box-sizing: border-box;
}

#graph-nav text {
    transform: translateY(2px);
}

.expression-node-wrapper {
    overflow-x: auto;
}

.mini-nav > ul {
    display: grid;
    grid-template-columns: 10ch 10ch 10ch;
    list-style-type: none;
}

.expression-node {
    display: flex;
    height: calc(100vh - 24px - 24px);
}

.expression-node > * {
    padding: 1rem;
    max-height: 100%;
    overflow-y: auto;
}

.expression-node > nav.main-nav {
    padding-top: 24px;
    border-right: 2px solid #ccc;
    flex-shrink: 0;
}

.node-details {
    flex-grow: 1;
    flex-shrink: 1;
}

.node-details[data-has-error]{
    background: #ffcccc;
}

.node-details[data-is-skipped]{
    background: #eee;
}

.node-creation-stack {
    font-size: 1rem;
}

.main-nav:not([data-is-open]){
    display: none;
}

.main-nav[data-is-open] + .node-details {
    min-width: min(95%, 25rem);
}

.nav-legend-current-node {
    display: flex;
    background: var(--current-node-color);
    border: 4px solid black;
    font-size: 1.2rem;
    padding: 3px;
}

.nav-legend-current-node + * {
    margin-top: 2rem;
}

.current-node polygon {

    fill: var(--current-node-color);
    stroke-width: 3;
}

.icon-button {
    position: absolute;
    left: 5px;
    top: 5px;
    padding: 2px;
    width: 24px;
    height: 24px;
}

.error-node polygon {
    stroke: red;
    stroke-width: 3;
}

.skipped-node polygon {
    stroke-dasharray: 4;
}
    </style>
</head>

<body>
    <div id="graph-nav" data-node-status='{"0": "success", "1": "success", "2": "success", "3": "success", "4": "success", "5": "success", "6": "success", "7": "success", "8": "success", "9": "success", "10": "success", "11": "success", "12": "success", "13": "success"}'>
        <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.0.0 (20240803.0821)
 -->
<!-- Title: G Pages: 1 -->
<svg width="326pt" height="700pt"
 viewBox="0.00 0.00 326.02 700.47" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 696.47)">

<polygon fill="white" stroke="none" points="-4,4 -4,-696.47 322.02,-696.47 322.02,4 -4,4"/>
<!-- node_0 -->
<g id="node_0" class="node">

<g id="a_node_0"><a xlink:href="node_0.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 9, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;X = skrub.X(data.baskets[[&quot;ID&quot;]])">
<polygon fill="#c6d5f0" stroke="black" points="87.53,-688.47 13.88,-688.47 13.88,-659.7 87.53,-659.7 87.53,-688.47"/>
<polygon fill="none" stroke="black" points="91.53,-692.47 9.88,-692.47 9.88,-655.7 91.53,-655.7 91.53,-692.47"/>
<text text-anchor="start" x="21.08" y="-672.31" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">X: VAR &#39;X&#39;</text>
</a>
</g>
</g>
<!-- node_3 -->
<g id="node_3" class="node">

<g id="a_node_3"><a xlink:href="node_3.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 13, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;products = products[products[&quot;basket_ID&quot;].isin(X[&quot;ID&quot;])]">
<polygon fill="none" stroke="black" points="131.03,-619.7 42.38,-619.7 42.38,-590.93 131.03,-590.93 131.03,-619.7"/>
<text text-anchor="start" x="49.58" y="-603.54" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">GETITEM &#39;ID&#39;</text>
</a>
</g>
</g>
<!-- node_0&#45;&gt;node_3 -->
<g id="edge15" class="edge">

<path fill="none" stroke="black" d="M60.16,-655.54C64.38,-647.72 69.41,-638.38 73.95,-629.95"/>
<polygon fill="black" stroke="black" points="76.97,-631.74 78.63,-621.28 70.8,-628.42 76.97,-631.74"/>
</g>
<!-- node_10 -->
<g id="node_10" class="node">

<g id="a_node_10"><a xlink:href="node_10.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 25, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;X = X.merge(aggregated_products, left_on=&quot;ID&quot;, right_on=&quot;basket_ID&quot;).drop(">
<polygon fill="none" stroke="black" points="143.4,-166.31 0,-166.31 0,-137.54 143.4,-137.54 143.4,-166.31"/>
<text text-anchor="start" x="7.2" y="-150.15" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">CALLMETHOD &#39;merge&#39;</text>
</a>
</g>
</g>
<!-- node_0&#45;&gt;node_10 -->
<g id="edge4" class="edge">

<path fill="none" stroke="black" d="M42.53,-655.21C31.91,-630.29 14.7,-583.45 14.7,-541.54 14.7,-541.54 14.7,-541.54 14.7,-280.46 14.7,-241.03 37.69,-200.24 54.47,-175.72"/>
<polygon fill="black" stroke="black" points="57.17,-177.97 60.1,-167.79 51.46,-173.92 57.17,-177.97"/>
</g>
<!-- node_1 -->
<g id="node_1" class="node">

<g id="a_node_1"><a xlink:href="node_1.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 11, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;products = skrub.var(&quot;products&quot;, data.products)">
<polygon fill="none" stroke="black" points="314.02,-688.47 213.38,-688.47 213.38,-659.7 314.02,-659.7 314.02,-688.47"/>
<polygon fill="none" stroke="black" points="318.02,-692.47 209.38,-692.47 209.38,-655.7 318.02,-655.7 318.02,-692.47"/>
<text text-anchor="start" x="220.57" y="-672.31" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">VAR &#39;products&#39;</text>
</a>
</g>
</g>
<!-- node_2 -->
<g id="node_2" class="node">

<g id="a_node_2"><a xlink:href="node_2.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 13, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;products = products[products[&quot;basket_ID&quot;].isin(X[&quot;ID&quot;])]">
<polygon fill="none" stroke="black" points="283.9,-619.7 149.5,-619.7 149.5,-590.93 283.9,-590.93 283.9,-619.7"/>
<text text-anchor="start" x="156.7" y="-603.54" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">GETITEM &#39;basket_ID&#39;</text>
</a>
</g>
</g>
<!-- node_1&#45;&gt;node_2 -->
<g id="edge14" class="edge">

<path fill="none" stroke="black" d="M251.35,-655.54C245.66,-647.46 238.83,-637.76 232.75,-629.12"/>
<polygon fill="black" stroke="black" points="235.79,-627.35 227.17,-621.19 230.06,-631.38 235.79,-627.35"/>
</g>
<!-- node_5 -->
<g id="node_5" class="node">

<g id="a_node_5"><a xlink:href="node_5.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 13, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;products = products[products[&quot;basket_ID&quot;].isin(X[&quot;ID&quot;])]">
<polygon fill="none" stroke="black" points="234.9,-490.16 154.5,-490.16 154.5,-461.39 234.9,-461.39 234.9,-490.16"/>
<text text-anchor="start" x="161.7" y="-474" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">GETITEM ...</text>
</a>
</g>
</g>
<!-- node_1&#45;&gt;node_5 -->
<g id="edge10" class="edge">

<path fill="none" stroke="black" d="M276.31,-655.25C282.57,-645.3 289.48,-632.38 292.7,-619.7 295.85,-607.31 295.13,-603.48 292.7,-590.93 286.82,-560.47 286.1,-550.36 266.7,-526.16 257.27,-514.4 244.31,-504.33 231.98,-496.4"/>
<polygon fill="black" stroke="black" points="233.96,-493.51 223.6,-491.3 230.32,-499.49 233.96,-493.51"/>
</g>
<!-- node_4 -->
<g id="node_4" class="node">

<g id="a_node_4"><a xlink:href="node_4.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 13, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;products = products[products[&quot;basket_ID&quot;].isin(X[&quot;ID&quot;])]">
<polygon fill="none" stroke="black" points="257.77,-554.93 131.62,-554.93 131.62,-526.16 257.77,-526.16 257.77,-554.93"/>
<text text-anchor="start" x="138.82" y="-538.77" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">CALLMETHOD &#39;isin&#39;</text>
</a>
</g>
</g>
<!-- node_2&#45;&gt;node_4 -->
<g id="edge12" class="edge">

<path fill="none" stroke="black" d="M211.93,-590.69C209.39,-583.46 206.19,-574.34 203.25,-565.93"/>
<polygon fill="black" stroke="black" points="206.58,-564.85 199.96,-556.57 199.97,-567.16 206.58,-564.85"/>
</g>
<!-- node_3&#45;&gt;node_4 -->
<g id="edge13" class="edge">

<path fill="none" stroke="black" d="M110.4,-590.54C125.31,-581.87 144.78,-570.56 161.25,-560.98"/>
<polygon fill="black" stroke="black" points="162.86,-564.1 169.75,-556.05 159.34,-558.05 162.86,-564.1"/>
</g>
<!-- node_4&#45;&gt;node_5 -->
<g id="edge11" class="edge">

<path fill="none" stroke="black" d="M194.7,-525.92C194.7,-518.85 194.7,-509.98 194.7,-501.73"/>
<polygon fill="black" stroke="black" points="198.2,-501.88 194.7,-491.88 191.2,-501.88 198.2,-501.88"/>
</g>
<!-- node_6 -->
<g id="node_6" class="node">

<g id="a_node_6"><a xlink:href="node_6.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 18, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;vectorized_products = products.skb.apply(">
<polygon fill="none" stroke="black" points="256.9,-425.39 110.5,-425.39 110.5,-396.62 256.9,-396.62 256.9,-425.39"/>
<text text-anchor="start" x="117.7" y="-409.23" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">APPLY TableVectorizer</text>
</a>
</g>
</g>
<!-- node_5&#45;&gt;node_6 -->
<g id="edge9" class="edge">

<path fill="none" stroke="black" d="M192.31,-461.15C191.06,-454 189.48,-445.01 188.02,-436.67"/>
<polygon fill="black" stroke="black" points="191.52,-436.34 186.34,-427.09 184.62,-437.54 191.52,-436.34"/>
</g>
<!-- node_7 -->
<g id="node_7" class="node">

<g id="a_node_7"><a xlink:href="node_7.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 23, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;vectorized_products.groupby(&quot;basket_ID&quot;).agg(&quot;mean&quot;).reset_index()">
<polygon fill="none" stroke="black" points="256.77,-360.62 100.62,-360.62 100.62,-331.85 256.77,-331.85 256.77,-360.62"/>
<text text-anchor="start" x="107.82" y="-344.46" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">CALLMETHOD &#39;groupby&#39;</text>
</a>
</g>
</g>
<!-- node_6&#45;&gt;node_7 -->
<g id="edge8" class="edge">

<path fill="none" stroke="black" d="M182.62,-396.38C182.05,-389.31 181.35,-380.44 180.69,-372.19"/>
<polygon fill="black" stroke="black" points="184.19,-372.03 179.9,-362.34 177.21,-372.58 184.19,-372.03"/>
</g>
<!-- node_8 -->
<g id="node_8" class="node">

<g id="a_node_8"><a xlink:href="node_8.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 23, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;vectorized_products.groupby(&quot;basket_ID&quot;).agg(&quot;mean&quot;).reset_index()">
<polygon fill="none" stroke="black" points="239.52,-295.85 111.87,-295.85 111.87,-267.08 239.52,-267.08 239.52,-295.85"/>
<text text-anchor="start" x="119.07" y="-279.69" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">CALLMETHOD &#39;agg&#39;</text>
</a>
</g>
</g>
<!-- node_7&#45;&gt;node_8 -->
<g id="edge7" class="edge">

<path fill="none" stroke="black" d="M178.05,-331.61C177.71,-324.54 177.29,-315.67 176.89,-307.42"/>
<polygon fill="black" stroke="black" points="180.4,-307.39 176.42,-297.57 173.4,-307.73 180.4,-307.39"/>
</g>
<!-- node_9 -->
<g id="node_9" class="node">

<g id="a_node_9"><a xlink:href="node_9.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 23, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;vectorized_products.groupby(&quot;basket_ID&quot;).agg(&quot;mean&quot;).reset_index()">
<polygon fill="none" stroke="black" points="259.4,-231.08 86,-231.08 86,-202.31 259.4,-202.31 259.4,-231.08"/>
<text text-anchor="start" x="93.2" y="-214.92" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">CALLMETHOD &#39;reset_index&#39;</text>
</a>
</g>
</g>
<!-- node_8&#45;&gt;node_9 -->
<g id="edge6" class="edge">

<path fill="none" stroke="black" d="M175.05,-266.84C174.71,-259.77 174.29,-250.9 173.89,-242.65"/>
<polygon fill="black" stroke="black" points="177.4,-242.62 173.42,-232.8 170.4,-242.96 177.4,-242.62"/>
</g>
<!-- node_9&#45;&gt;node_10 -->
<g id="edge5" class="edge">

<path fill="none" stroke="black" d="M150.78,-202.07C136.98,-193.5 118.93,-182.28 103.56,-172.73"/>
<polygon fill="black" stroke="black" points="105.55,-169.84 95.21,-167.53 101.85,-175.79 105.55,-169.84"/>
</g>
<!-- node_11 -->
<g id="node_11" class="node">

<g id="a_node_11"><a xlink:href="node_11.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 25, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;X = X.merge(aggregated_products, left_on=&quot;ID&quot;, right_on=&quot;basket_ID&quot;).drop(">
<polygon fill="none" stroke="black" points="137.78,-97.54 5.62,-97.54 5.62,-68.77 137.78,-68.77 137.78,-97.54"/>
<text text-anchor="start" x="12.83" y="-81.38" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">CALLMETHOD &#39;drop&#39;</text>
</a>
</g>
</g>
<!-- node_10&#45;&gt;node_11 -->
<g id="edge3" class="edge">

<path fill="none" stroke="black" d="M71.7,-137.09C71.7,-129.03 71.7,-118.63 71.7,-109.18"/>
<polygon fill="black" stroke="black" points="75.2,-109.49 71.7,-99.49 68.2,-109.49 75.2,-109.49"/>
</g>
<!-- node_13 -->
<g id="node_13" class="node">

<g id="a_node_13"><a xlink:href="node_13.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 30, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;pred = X.skb.apply(classifier, y=y)">
<polygon fill="none" stroke="black" points="254.15,-28.77 13.25,-28.77 13.25,0 254.15,0 254.15,-28.77"/>
<text text-anchor="start" x="20.45" y="-12.61" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">APPLY HistGradientBoostingClassifier</text>
</a>
</g>
</g>
<!-- node_11&#45;&gt;node_13 -->
<g id="edge1" class="edge">

<path fill="none" stroke="black" d="M84.55,-68.32C92.78,-59.46 103.64,-47.76 113.06,-37.61"/>
<polygon fill="black" stroke="black" points="115.6,-40.02 119.84,-30.31 110.47,-35.26 115.6,-40.02"/>
</g>
<!-- node_12 -->
<g id="node_12" class="node">

<g id="a_node_12"><a xlink:href="node_12.html" xlink:title=" &#160;&#160;&#160;&#160;&#160;File &quot;/home/jerome/workspace/scratch/2025/01/expr&#45;presentation/fraud_skrub.py&quot;, line 10, in &lt;module&gt;&#10; &#160;&#160;&#160;&#160;&#160;&#160;&#160;y = skrub.y(data.baskets[&quot;fraud_flag&quot;])">
<polygon fill="#fad9c6" stroke="black" points="231.4,-97.54 160,-97.54 160,-68.77 231.4,-68.77 231.4,-97.54"/>
<polygon fill="none" stroke="black" points="235.4,-101.54 156,-101.54 156,-64.77 235.4,-64.77 235.4,-101.54"/>
<text text-anchor="start" x="167.2" y="-81.38" font-family="sans-serif" font-weight="bold" font-size="12.00" fill="#1a0dab">y: VAR &#39;y&#39;</text>
</a>
</g>
</g>
<!-- node_12&#45;&gt;node_13 -->
<g id="edge2" class="edge">

<path fill="none" stroke="black" d="M179.41,-64.61C171.66,-56.27 162.31,-46.2 154.1,-37.35"/>
<polygon fill="black" stroke="black" points="156.76,-35.07 147.39,-30.13 151.63,-39.84 156.76,-35.07"/>
</g>
</g>
</svg>

    </div>
</body>
<script>
 (function() {

    function highlightCurrentNode() {
        const graphDiv = document.getElementById('graph-nav');
        const currentNode = graphDiv.dataset.currentNodeId;
        const nodeElem = document.getElementById(currentNode);
        if (nodeElem === null){
            return;
        }
        nodeElem.classList.add('current-node');
    }
    highlightCurrentNode();

    function toggleNav() {
        const nav = document.querySelector("nav");
        if (nav === null){
            return;
        }
        if (nav.hasAttribute("data-is-open")) {
            nav.removeAttribute("data-is-open");
        } else {
            nav.setAttribute("data-is-open", "");
        }
    }
    const toggleNavButton = document.getElementById('toggle-nav');
    if (toggleNavButton !== null){
        toggleNavButton.addEventListener("click", toggleNav);
    }

    function showNodeStatus() {
        const graphDiv = document.getElementById('graph-nav');
        console.log(graphDiv.dataset.nodeStatus);
        const nodeStatus = JSON.parse(graphDiv.dataset.nodeStatus);
        console.log(nodeStatus);
        for (const nodeId in nodeStatus) {
            const nodeElem = document.getElementById(`node_${nodeId}`);
            console.log(nodeElem);
            switch (nodeStatus[nodeId]) {
            case 'success':
                nodeElem.classList.add('success-node');
                break;
            case 'error':
                nodeElem.classList.add('error-node');
                break;
                default:
                    nodeElem.classList.add('skipped-node');
                    break;
            }
        }
    }
    showNodeStatus();
})();
</script>

</html>